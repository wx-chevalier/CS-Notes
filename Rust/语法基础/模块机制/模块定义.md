# mod

æ¨¡å—é€šè¿‡å…³é”®å­— mod åŠ æ¨¡å—å®šä¹‰, ä¾‹å¦‚:

```rs
mod front_of_house {
    mod hosting {
        fn add_to_waitlist() {}

        fn seat_at_table() {}
    }

    mod serving {
        fn take_order() {}

        fn serve_order() {}

        fn take_payment() {}
    }
}
```

æ–‡ä»¶ src/main.rs å’Œ src/lib.rs, å¯¹åº”çš„æ¨¡å—æ˜¯ crate, ç®±(crate)çš„æ¨¡å—ç»“æ„(module structure), ä¹Ÿå«åšæ¨¡å—æ ‘(module tree):

```rs
crate
 â””â”€â”€ front_of_house
     â”œâ”€â”€ hosting
     â”‚   â”œâ”€â”€ add_to_waitlist
     â”‚   â””â”€â”€ seat_at_table
     â””â”€â”€ serving
         â”œâ”€â”€ take_order
         â”œâ”€â”€ serve_order
         â””â”€â”€ take_payment
```

æ¨¡å— crate é»˜è®¤å­˜åœ¨, ä¸éœ€è¦é€šè¿‡å…³é”®å­— mod æ–¹å¼æ¥å®šä¹‰ã€‚ä¸æ–‡ä»¶ç³»ç»Ÿç±»ä¼¼, æ–‡ä»¶ç³»ç»Ÿçš„æ ¹èŠ‚ç‚¹æ˜¯ /, ç®±(crate)çš„æ ¹èŠ‚ç‚¹æ˜¯ `crate`.

- ç»å¯¹è·¯å¾„ï¼Œä»ç®±(crate)çš„æ ¹èŠ‚ç‚¹å¼€å§‹, ç®±(crate)çš„åç§°, æˆ– `crate`
- ç›¸å¯¹è·¯å¾„ï¼Œä»å½“å‰æ¨¡å—å¼€å§‹, å¯ä»¥ä½¿ç”¨ `self`, `super`

```rust
// æ–‡ä»¶å†…ç»å¯¹è·¯å¾„ Absolute path
crate::front_of_house::hosting::add_to_waitlist();

// ç›¸å¯¹è·¯å¾„ Relative path
front_of_house::hosting::add_to_waitlist();
```

# åŒæ–‡ä»¶æ¨¡å—

ç›¸å…³ä»£ç å’Œæ•°æ®è¢«åˆ†ç»„åˆ°ä¸€ä¸ªæ¨¡å—ä¸­å¹¶å­˜å‚¨åœ¨åŒä¸€æ–‡ä»¶ä¸­ã€‚

```rs
fn main() {
   greetings::hello();
}

mod greetings {
  // â­ï¸ By default, everything inside a module is private
  pub fn hello() { // â­ï¸ So function has to be public to access from outside
    println!("Hello, world!");
  }
}
```

æ¨¡å—ä¹Ÿå¯ä»¥åµŒå¥—ã€‚

```rs
fn main() {
  phrases::greetings::hello();
}

mod phrases {
  pub mod greetings {
    pub fn hello() {
      println!("Hello, world!");
    }
  }
}
```

self å…³é”®å­—ç”¨äºå¼•ç”¨ç›¸åŒçš„æ¨¡å—ï¼Œè€Œ super å…³é”®å­—ç”¨äºå¼•ç”¨çˆ¶æ¨¡å—ã€‚è¿˜å¯ä»¥ä½¿ç”¨ super å…³é”®å­—ä»æ¨¡å—å†…éƒ¨è®¿é—®æ ¹å‡½æ•°ã€‚

```rs
fn main() {
  greetings::hello();
}

fn hello() {
  println!("Hello, world!");
}

mod greetings {
  pub fn hello() {
    super::hello();
  }
}
```

ç¼–å†™æµ‹è¯•æ—¶ï¼Œæœ€å¥½åœ¨æµ‹è¯•æ¨¡å—ä¸­ç¼–å†™æµ‹è¯•ï¼Œå› ä¸ºå®ƒä»¬ä»…åœ¨è¿è¡Œæµ‹è¯•æ—¶æ‰ç¼–è¯‘ã€‚

```rs
fn greet() -> String {
    "Hello, world!".to_string()
}

#[cfg(test)] // only compiles when running tests
mod tests {
    use super::greet; // import root greet function

    #[test]
    fn test_greet() {
        assert_eq!("Hello, world!", greet());
    }
}
```

# æ¨¡å—å¯è§æ€§

- æ‰€æœ‰å…ƒç´ , å‡½æ•° functions, æ–¹æ³• methods, ç»“æ„ä½“ structs, æšä¸¾ enum, æ¨¡å— modules, å¸¸é‡ constants, é»˜è®¤æ˜¯ç§æœ‰çš„, å¯¹å¤–å…¬å¼€(public), éœ€è¦é€šè¿‡å…³é”®å­—`pub`å£°æ˜
  - å³ä¾¿æ˜¯å…±æœ‰çš„ç»“æ„ä½“(public structs), å†…éƒ¨çš„å…ƒç´ (fields)å’Œæ–¹æ³•(methods)ä»æ˜¯ç§æœ‰çš„(private)
  - å…±æœ‰çš„æšä¸¾(public enums), å…¶æ‰€æœ‰å˜å¤©(variants)ä¹ŸåŒä¸ºå…±æœ‰(public)
- çˆ¶æ¨¡å—ä¸­çš„å…ƒç´ , **ä¸èƒ½**ä½¿ç”¨å­æ¨¡å—ä¸­çš„ç§æœ‰å…ƒç´ 
- å­æ¨¡å—ä¸­çš„å…ƒç´ , **å¯ä»¥**ä½¿ç”¨çˆ¶æ¨¡å—çš„å…ƒç´ 

è­¬å¦‚å°†åˆ¶ä½œä¸€ä¸ªåä¸º print_things çš„ modï¼Œå®ƒå…·æœ‰ä¸€äº›ä¸æ‰“å°ç›¸å…³çš„åŠŸèƒ½ã€‚

```rs
mod print_things {
    use std::fmt::Display;

    fn prints_one_thing<T: Display>(input: T) { // Print anything that implements Display
        println!("{}", input)
    }
}

fn main() {}
```

å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åœ¨ print_things é‡Œé¢å†™äº†`std::fmt::Display;`ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªå•ç‹¬çš„ç©ºé—´ã€‚å¦‚æœæ‚¨åœ¨ main()ä¸­ä½¿ç”¨`std::fmt::Display;`ç¼–å†™ï¼Œå°†æ— æµäºäº‹ã€‚åŒæ ·ï¼Œæˆ‘ä»¬ç°åœ¨ä¸èƒ½ä»`main()`è°ƒç”¨å®ƒã€‚å¦‚æœåœ¨ fn å‰é¢æ²¡æœ‰ pub å…³é”®å­—ï¼Œå®ƒå°†ä¿æŒç§æœ‰çŠ¶æ€ã€‚è®©æˆ‘ä»¬å°è¯•åœ¨æ²¡æœ‰å‘å¸ƒçš„æƒ…å†µä¸‹è°ƒç”¨å®ƒã€‚è¿™æ˜¯ä¸€ç§ç¼–å†™æ–¹å¼ï¼š

```rs
// ğŸš§
fn main() {
    crate::print_things::prints_one_thing(6);
}
```

`crate` æ„å‘³ç€åœ¨è¯¥æ–‡ä»¶ä¸­ã€‚é‡Œé¢æ˜¯ mod print_thingsï¼Œæœ€åæ˜¯ prints_one_thing() å‡½æ•°ã€‚æ‚¨å¯ä»¥æ¯æ¬¡ç¼–å†™è¯¥ä»£ç ï¼Œä¹Ÿå¯ä»¥ç¼–å†™ç”¨äºå¯¼å…¥çš„ç”¨æ³•ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é”™è¯¯æç¤ºå®ƒæ˜¯ç§æœ‰çš„ï¼š

```rs
// âš ï¸
mod print_things {
    use std::fmt::Display;

    fn prints_one_thing<T: Display>(input: T) {
        println!("{}", input)
    }
}

fn main() {
    use crate::print_things::prints_one_thing;

    prints_one_thing(6);
    prints_one_thing("Trying to print a string...".to_string());
}

error[E0603]: function `prints_one_thing` is private
  --> src\main.rs:10:30
   |
10 |     use crate::print_things::prints_one_thing;
   |                              ^^^^^^^^^^^^^^^^ private function
   |
note: the function `prints_one_thing` is defined here
  --> src\main.rs:4:5
   |
4  |     fn prints_one_thing<T: Display>(input: T) {
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
```

å¾ˆå®¹æ˜“ç†è§£å‡½æ•° print_one_thing æ˜¯ç§æœ‰çš„ã€‚å®ƒè¿˜æ˜¾ç¤ºäº†åœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°è¯¥å‡½æ•°ã€‚è¿™æ˜¯å› ä¸ºä¸€æ—¦å¼€å§‹ä½¿ç”¨ modï¼Œæ‚¨å¯èƒ½è¿˜ä¼šä½¿ç”¨å¤šä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”å¾ˆéš¾æ‰¾åˆ°å†…å®¹ã€‚ç°åœ¨æˆ‘ä»¬åªå†™ pub fn è€Œä¸æ˜¯ fnï¼Œä¸€åˆ‡æ­£å¸¸ã€‚

```rs
mod print_things {
    use std::fmt::Display;

    pub fn prints_one_thing<T: Display>(input: T) {
        println!("{}", input)
    }
}

fn main() {
    use crate::print_things::prints_one_thing;

    prints_one_thing(6);
    prints_one_thing("Trying to print a string...".to_string());
}

6
Trying to print a string...
```

# pub è§„åˆ™

ç»“æ„ï¼Œæšä¸¾ï¼Œç‰¹å¾æˆ–æ¨¡å—çš„`pub`æ€ä¹ˆæ ·ï¼Ÿ pub å¯¹ä»–ä»¬æ¥è¯´æ˜¯è¿™æ ·çš„ï¼š

- Structï¼šå°†ç»“æ„å…¬å¼€ï¼Œä½†é¡¹ç›®ä¸å…¬å¼€ã€‚è¦å…¬å¼€ä¸€ä¸ªé¡¹ç›®ï¼Œæ‚¨ä¹Ÿå¿…é¡»ä¸ºæ¯ä¸ªé¡¹ç›®éƒ½å†™ä¸€ä¸ª `pub`ã€‚
- Enum æˆ–è€… Traitï¼šä¸€åˆ‡éƒ½å…¬å¼€äº†ã€‚è¿™æ˜¯æœ‰é“ç†çš„ï¼Œå› ä¸ºç‰¹è´¨æ˜¯å…³äºèµ‹äºˆæŸç‰©ç›¸åŒçš„è¡Œä¸ºã€‚æšä¸¾æ˜¯å…³äºé¡¹ç›®ä¹‹é—´çš„é€‰æ‹©çš„ï¼Œæ‚¨éœ€è¦æŸ¥çœ‹å®ƒä»¬æ‰èƒ½é€‰æ‹©å®ƒä»¬ã€‚
- Moduleï¼šç¬¬ä¸€ä¸ªæ¨¡å—å°†æ˜¯ `pub`ï¼Œå› ä¸ºå¦‚æœä¸æ˜¯ pubï¼Œé‚£ä¹ˆä»»ä½•äººéƒ½æ— æ³•è§¦æ‘¸å…¶ä¸­çš„ä»»ä½•å†…å®¹ã€‚ä½†æ˜¯æ¨¡å—å†…éƒ¨çš„æ¨¡å—éœ€è¦å°† `pub` å…¬å¼€ã€‚

å› æ­¤ï¼Œè®©æˆ‘ä»¬åœ¨ print_things ä¸­æ”¾ç½®ä¸€ä¸ªåä¸º Billy çš„ç»“æ„ã€‚è¿™ä¸ªç»“æ„å‡ ä¹æ˜¯æ‰€æœ‰å…¬å¼€çš„ï¼Œä½†ä¸æ˜¯å®Œå…¨å…¬å¼€çš„ã€‚è¯¥ç»“æ„æ˜¯å…¬å…±çš„ï¼Œå› æ­¤ä¼šè¯´å‘å¸ƒç»“æ„ Billyã€‚é‡Œé¢ä¼šæœ‰ä¸€ä¸ªåå­—å’Œ times_to_printã€‚åç§°ä¸ä¼šæ˜¯å…¬å…±çš„ï¼Œå› ä¸ºæˆ‘ä»¬åªå¸Œæœ›ç”¨æˆ·åˆ›å»ºåä¸º `"Billy".to_string()` çš„ç»“æ„ã€‚ä½†æ˜¯ç”¨æˆ·å¯ä»¥é€‰æ‹©æ‰“å°æ¬¡æ•°ï¼Œè¿™æ ·å¯ä»¥å…¬å¼€æ˜¾ç¤ºã€‚çœ‹èµ·æ¥åƒè¿™æ ·ï¼š

```rs
mod print_things {
    use std::fmt::{Display, Debug};

    #[derive(Debug)]
    pub struct Billy { // Billy is public
        name: String, // but name is private.
        pub times_to_print: u32,
    }

    impl Billy {
        pub fn new(times_to_print: u32) -> Self { // That means the user needs to use new to create a Billy. The user can only input times_to_print
            Self {
                name: "Billy".to_string(), // We choose the name - the user can't
                times_to_print,
            }
        }

        pub fn print_billy(&self) { // This function prints a Billy
            for _ in 0..self.times_to_print {
                println!("{:?}", self.name);
            }
        }
    }

    pub fn prints_one_thing<T: Display>(input: T) {
        println!("{}", input)
    }


}

fn main() {
    use crate::print_things::*; // Now we use *. This imports everything from print_things

    let my_billy = Billy::new(3);
    my_billy.print_billy();

}

"Billy"
"Billy"
"Billy"
```

# æ¨¡å—åµŒå¥—

åœ¨ mod å†…éƒ¨ï¼Œæ‚¨å¯ä»¥åˆ›å»ºå…¶ä»– modã€‚å­æ¨¡å—ï¼ˆæ¨¡å—å†…éƒ¨çš„æ¨¡å—ï¼‰å§‹ç»ˆå¯ä»¥ä½¿ç”¨çˆ¶æ¨¡å—å†…éƒ¨çš„ä»»ä½•æ¨¡å—ã€‚æ‚¨å¯ä»¥åœ¨ä¸‹ä¸€ä¸ªç¤ºä¾‹ä¸­çœ‹åˆ°è¿™ä¸€ç‚¹ï¼Œåœ¨è¯¥ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åœ¨ mod å›½å®¶çš„ mod çœå†…æœ‰ä¸€ä¸ª mod åŸå¸‚ã€‚æ‚¨å¯ä»¥æƒ³åˆ°è¿™æ ·çš„ç»“æ„ï¼šå³ä½¿æ‚¨åœ¨ä¸€ä¸ªå›½å®¶ä¸­ï¼Œä¹Ÿå¯èƒ½ä¸åœ¨ä¸€ä¸ªçœä¸­ã€‚å³ä½¿æ‚¨åœ¨çœä»½ä¸­ï¼Œä¹Ÿå¯èƒ½ä¸åœ¨åŸå¸‚ä¸­ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨åœ¨åŸå¸‚ä¸­ï¼Œé‚£ä¹ˆæ‚¨å°†åœ¨å…¶çœä»½ä¸­ï¼Œå¹¶ä¸”æ‚¨æ˜¯å…¶å›½å®¶/åœ°åŒºã€‚

```rs
mod country { // The main mod doesn't need pub
    fn print_country(country: &str) { // Note: this function isn't public
        println!("We are in the country of {}", country);
    }
    pub mod province { // Make this mod public

        fn print_province(province: &str) { // Note: this function isn't public
            println!("in the province of {}", province);
        }

        pub mod city { // Make this mod public
            pub fn print_city(country: &str, province: &str, city: &str) {  // This function is public though
                crate::country::print_country(country);
                crate::country::province::print_province(province);
                println!("in the city of {}", city);
            }
            }
        }
    }

fn main() {
    crate::country::province::city::print_city("Canada", "New Brunswick", "Moncton");
}

```

æœ‰è¶£çš„æ˜¯ï¼Œprint_city å¯ä»¥è®¿é—® print_province å’Œ print_countryã€‚è¿™æ˜¯å› ä¸º mod city åœ¨å…¶ä»– mod å†…ã€‚å®ƒä¸éœ€è¦åœ¨ print_province å‰é¢çš„ pub æ¥ä½¿ç”¨å®ƒã€‚è¿™æ˜¯æœ‰é“ç†çš„ï¼šåŸå¸‚ä¸éœ€è¦åœ¨çœå†…å’Œå›½å®¶å†…åšä»»ä½•äº‹æƒ…ã€‚æ‚¨å¯èƒ½æ³¨æ„åˆ°äº† `crate::country::province::print_province(province);` å¾ˆé•¿ï¼Œå½“æˆ‘ä»¬åœ¨æ¨¡å—å†…éƒ¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ super ä»ä¸Šæ–¹å¼•å…¥é¡¹ç›®ã€‚å®é™…ä¸Šï¼Œâ€œè¶…çº§â€ä¸€è¯æœ¬èº«çš„æ„æ€æ˜¯â€œåœ¨...ä¹‹ä¸Šâ€ï¼Œå°±åƒåœ¨â€œé«˜çº§â€ä¸­ä¸€æ ·ã€‚åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åªä½¿ç”¨äº†ä¸€æ¬¡å‡½æ•°ï¼Œä½†æ˜¯å¦‚æœæ‚¨å†ä½¿ç”¨ä¸€æ¬¡ï¼Œåˆ™å¯¼å…¥æ˜¯ä¸ªå¥½ä¸»æ„ã€‚å¦‚æœå®ƒä½¿æ‚¨çš„ä»£ç æ›´æ˜“äºé˜…è¯»ï¼Œå³ä½¿æ‚¨åªä½¿ç”¨ä¸€æ¬¡è¯¥å‡½æ•°ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚ç°åœ¨çš„ä»£ç å‡ ä¹ç›¸åŒï¼Œä½†æ›´æ˜“äºé˜…è¯»ï¼š

```rs
mod country {
    fn print_country(country: &str) {
        println!("We are in the country of {}", country);
    }
    pub mod province {
        fn print_province(province: &str) {
            println!("in the province of {}", province);
        }

        pub mod city {
            use super::super::*; // use everything in "above above": that means mod country
            use super::*;        // use everything in "above": that means mod province

            pub fn print_city(country: &str, province: &str, city: &str) {
                print_country(country);
                print_province(province);
                println!("in the city of {}", city);
            }
        }
    }
}

fn main() {
    use crate::country::province::city::print_city; // bring in the function

    print_city("Canada", "New Brunswick", "Moncton");
    print_city("Korea", "Gyeonggi-do", "Gwangju"); // Now it's less work to use it again
}
```

# Re-exporting

æˆ‘ä»¬å¯ä»¥ç»“åˆä½¿ç”¨ `pub use` æ¥å®ç° `Re-exporting`ã€‚`Re-exporting` çš„å­—é¢æ„æ€å°±æ˜¯é‡æ–°å¯¼å‡ºã€‚å®ƒçš„æ„æ€æ˜¯è¿™æ ·çš„ï¼ŒæŠŠæ·±å±‚çš„ item å¯¼å‡ºåˆ°ä¸Šå±‚ç›®å½•ä¸­ï¼Œä½¿è°ƒç”¨çš„æ—¶å€™ï¼Œæ›´æ–¹ä¾¿ã€‚æ¥å£è®¾è®¡ä¸­ä¼šå¤§é‡ç”¨åˆ°è¿™ä¸ªæŠ€æœ¯ã€‚å¯¹äºæ·±å±‚å¼•ç”¨ `a::b::c::d` çš„ä¾‹å­ã€‚æˆ‘ä»¬åœ¨ `main.rs` ä¸­ï¼Œè¦è°ƒç”¨ `d`ï¼Œå¾—ä½¿ç”¨ `use a::b::c::d;` æ¥è°ƒç”¨ã€‚è€Œå¦‚æœæˆ‘ä»¬ä¿®æ”¹ `a/mod.rs` æ–‡ä»¶ä¸ºï¼š `a/mod.rs` æ–‡ä»¶å†…å®¹ï¼š

```rust
pub mod b;
pub use b::c::d;
```

é‚£ä¹ˆï¼Œæˆ‘ä»¬åœ¨ `main.rs` ä¸­ï¼Œå°±å¯ä»¥ä½¿ç”¨ `use a::d;` æ¥è°ƒç”¨äº†ã€‚ä»è¿™ä¸ªä¾‹å­æ¥çœ‹æ²¡è§‰å¾—æ–¹ä¾¿å¤šå°‘ã€‚ä½†æ˜¯å¦‚æœå¼€å‘çš„ä¸€ä¸ªåº“ä¸­æœ‰å¤§é‡çš„å†…å®¹ï¼Œè€Œä¸”æ˜¯åœ¨ä¸åŒå±‚æ¬¡çš„æ¨¡å—ä¸­ã€‚é‚£ä¹ˆï¼Œé€šè¿‡ç»Ÿä¸€å¯¼å‡ºåˆ°ä¸€ä¸ªåœ°æ–¹ï¼Œå°±èƒ½å¤§å¤§æ–¹ä¾¿æ¥å£ä½¿ç”¨è€…ã€‚
